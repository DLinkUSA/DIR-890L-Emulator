<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0033)http://192.168.0.1/GuestZone.html -->
<html xmlns="http://www.w3c.org/1999/xhtml" xml:lang="zh_TW" lang="zh_TW"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>D-LINK</title>
<meta http-equiv="X-UA-Compatible" content="IE=9">

<meta http-equiv="Content-Type" content="text/css">
<link href="resources/jquery.selectbox.css" type="text/css" rel="stylesheet">
<script type="text/javascript" charset="utf-8" src="resources/initialJS.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/comm.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/hmac_md5.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/libajax.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/hnap.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/i18n.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/pagetool.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/menu.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/DetectRouterConnection.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/checkTimeout.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/includeLang.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/AES.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/DeviceConfig.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/initialCSS.js"></script>
<link rel="stylesheet" type="text/css" href="resources/style_pages.css" media="all">
<script type="text/javascript" charset="utf-8" src="resources/initialJQ.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/jquery-1.8.2.min.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/jquery.selectbox-0.2_new.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/jquery.stringify.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/initialValidate.js"></script>
<script type="text/javascript" charset="utf-8" src="resources/jquery.validate.js"></script>

<script>
$(document).ready(function(){
	presetCheckBox("status_gz_24", true);
	presetCheckBox("status_gz_5", true);
	presetCheckBox("status_gz_5hi", true);
	presetCheckBox("internetAccessOnly", true);
	presetCheckBox("status_smartconnect", false);
	
	//jquery
	$("div.checkbox_on" || "div.checkbox_off").click(function(e) {
	 var checkboxId =  e.target.id +'_ck';
		if(e.target.getAttribute("class") == "checkbox_on") {
			var disable = I18N("j","Disabled");
			e.target.setAttribute("class", "checkbox_off");
			e.target.setAttribute("className", "checkbox_off");
			document.getElementById(e.target.id).innerHTML='<input type="checkbox" name=' + e.target.id + ' id=' + checkboxId + ' checked>'+disable;
			document.getElementById(checkboxId).checked=false;
			if (checkboxId == "status_gz_24_ck")
			{
				document.getElementById("wifiName_24g").disabled = true;
				document.getElementById("password_24g").disabled = true;
				Show_Table();
				if (Get24GHzHostZoneResult == "false")	{	GetHostZoneEnabled_24 -= 1;	}
			}
			if (checkboxId == "status_gz_5_ck")
			{
				document.getElementById("wifiName_5g").disabled = true;
				document.getElementById("password_5g").disabled = true;
				Show_Table();
				if (Get5GHzHostZoneResult == "false")	{	GetHostZoneEnabled_5 -= 1;	}
			}
			if (checkboxId == "status_gz_5hi_ck")
			{
				document.getElementById("wifiName_5g_hi").disabled = true;
				document.getElementById("password_5g_hi").disabled = true;
				Show_Table();
				if (Get5GHzHostZoneResult_hi == "false")	{	GetHostZoneEnabled_5hi -= 1;	}
			}
			changeFlag = true;
			save_button_changed();
		}
		else {
			var enable = I18N("j","Enabled");
			e.target.setAttribute("class", "checkbox_on");
			e.target.setAttribute("className", "checkbox_on");
			document.getElementById(e.target.id).innerHTML='<input type="checkbox" name=' + e.target.id + ' id=' + checkboxId + ' checked="">'+enable;
			document.getElementById(checkboxId).checked=true;

			if (checkboxId == "status_gz_24_ck")
			{
				document.getElementById("wifiName_24g").disabled = false;
				document.getElementById("password_24g").disabled = false;
				Show_Table();
				if (Get24GHzHostZoneResult == "false")	{	GetHostZoneEnabled_24 += 1;	}
			}
			if (checkboxId == "status_gz_5_ck")
			{
				document.getElementById("wifiName_5g").disabled = false;
				document.getElementById("password_5g").disabled = false;
				Show_Table();
				if (Get5GHzHostZoneResult == "false")	{	GetHostZoneEnabled_5 += 1;	}
			}
			if (checkboxId == "status_gz_5hi_ck")
			{
				document.getElementById("wifiName_5g_hi").disabled = false;
				document.getElementById("password_5g_hi").disabled = false;
				Show_Table();
				if (Get5GHzHostZoneResult_hi == "false")	{	GetHostZoneEnabled_5hi += 1;	}
			}
			changeFlag = true;
			save_button_changed();
		}
	});
});

</script>

<script type="text/javascript">
	var HNAP = new HNAP_XML();
	var Get24GHzHostZoneResult = "";
	var Get5GHzHostZoneResult = "";
	var Get5GHzHostZoneResult_hi = "";
	var GetHostZoneEnabled_24 = 0;
	var GetHostZoneEnabled_5 = 0;
	var GetHostZoneEnabled_5hi = 0;
	var GetHostZoneEnabled = 0;
	var HNAP_WLanRadioSettings;
	var HNAP_WLanRadioSecurity;
	var n24G_SSID, n24G_Mode, n24G_Channel, n24G_TXPower, n24G_ChannelWidth, n24G_Visibility;
	var n5G_SSID, n5G_Mode, n5G_Channel, n5G_TXPower, n5G_ChannelWidth, n5G_Visibility;
	var n5G_SSID_hi, n5G_Mode_hi, n5G_Channel_hi, n5G_TXPower_hi, n5G_ChannelWidth_hi, n5G_Visibility_hi;
	var _ReciprocalNumber = 25;
	function Load_HTML()	{	$("#header").load("header.html");	}
	function Initial()
	{
		initialMenu();
		initialDetectRouterConnection();
	}
	function GetXML()	{	HNAP.GetXMLAsync("GetMultipleHNAPs", null, "GetXML", function(xml)	{	GetResult_1st(xml)	});	}
	function GetResult_1st(result_xml)
	{
		if (result_xml != null)
		{
			result_xml.Set("GetMultipleHNAPs/GetWLanRadioSettings:1/RadioID", "RADIO_2.4G_Guest");
			result_xml.Set("GetMultipleHNAPs/GetWLanRadioSecurity:1/RadioID", "RADIO_2.4G_Guest");
			result_xml.Set("GetMultipleHNAPs/GetWLanRadioSettings:2/RadioID", "RADIO_5G_Guest");
			result_xml.Set("GetMultipleHNAPs/GetWLanRadioSecurity:2/RadioID", "RADIO_5G_Guest");
			result_xml.Set("GetMultipleHNAPs/GetWLanRadioSettings:3/RadioID", "RADIO_5GHz_2_Guest");
			result_xml.Set("GetMultipleHNAPs/GetWLanRadioSecurity:3/RadioID", "RADIO_5GHz_2_Guest");
			result_xml.Set("GetMultipleHNAPs/GetWLanRadioSettings:4/RadioID", "RADIO_2.4GHz");
			result_xml.Set("GetMultipleHNAPs/GetWLanRadioSecurity:4/RadioID", "RADIO_2.4GHz");
			result_xml.Set("GetMultipleHNAPs/GetWLanRadioSettings:5/RadioID", "RADIO_5GHz");
			result_xml.Set("GetMultipleHNAPs/GetWLanRadioSettings:6/RadioID", "RADIO_5GHz_2");
			result_xml.Set("GetMultipleHNAPs/GetGuestZoneRouterSettings");
			result_xml.Set("GetMultipleHNAPs/GetSmartconnectSettings");
			HNAP.SetXMLAsync("GetMultipleHNAPs", result_xml, function(xml)	{	GetResult_2nd(xml);	});
		}
		else	{	if (DebugMode == 1)	{	alert("[!!GetXML Error!!] Function: GetResult_1st");	}	}
	}
	function GetResult_2nd(result_xml)
	{
		var GetResult_2nd = result_xml.Get("GetMultipleHNAPsResponse/GetMultipleHNAPsResult");
		if (GetResult_2nd == "OK")
		{
			//smart connect
			var smart_connect = result_xml.Get("GetMultipleHNAPsResponse/GetSmartconnectSettingsResponse/Enabled");
			if (smart_connect == "true")
			{
				document.getElementById("SMART_CONNECT").style.display = "block";
				document.getElementById("GUEST_2GHz").style.display = "none";
				document.getElementById("GUEST_5GHz").style.display = "none";
				document.getElementById("GUEST_5GHz_hi").style.display = "none";
				document.getElementById("separated_line").style.display = "none";
				document.getElementById("separated_line_2GHz").style.display = "none";
				document.getElementById("separated_line_5GHz").style.display = "none";
				
				var ssid = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/SSID");
				document.getElementById("wifiName_smartconnect").value = ssid;
				var security_status = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:4/Enabled");
				
				if(security_status != "false")
				{
					var password = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:4/Key");
					document.getElementById("password_smartconnect").value = password;
				}
				
				document.getElementById("wifiName_smartconnect").disabled = true;
				document.getElementById("password_smartconnect").disabled = true;
			}
			else
			{
				document.getElementById("SMART_CONNECT").style.display = "none";
				document.getElementById("GUEST_2GHz").style.display = "table-row";
				document.getElementById("GUEST_5GHz").style.display = "table-row";
				document.getElementById("GUEST_5GHz_hi").style.display = "table-row";
				document.getElementById("separated_line").style.display = "none";
				document.getElementById("separated_line_2GHz").style.display = "block";
				document.getElementById("separated_line_5GHz").style.display = "block";
				
				//2.4g
				var radio_guest24 = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse/Enabled");
				Get24GHzHostZoneResult = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/Enabled");
				if (radio_guest24 == "true" && Get24GHzHostZoneResult == "true")	{ presetCheckBox("status_gz_24", true); }
				else
				{
					presetCheckBox("status_gz_24", false);
					document.getElementById("wifiName_24g").disabled = true;
					document.getElementById("password_24g").disabled = true;
					//Get24GHzHostZoneResult = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/Enabled");
				}
				var ssid_guest24 = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:1/SSID");
				document.getElementById("wifiName_24g").value = ssid_guest24;
				var security_24_status = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:1/Enabled");
				if(security_24_status != "false")
				{
					var password_guest24 = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:1/Key");
					document.getElementById("password_24g").value = password_guest24;
				}
				//5g low band
				var radio_guest5 = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:2/Enabled");
				Get5GHzHostZoneResult = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:5/Enabled");
				if(radio_guest5 == "true" && Get5GHzHostZoneResult == "true")	{	presetCheckBox("status_gz_5", true);	}
				else
				{
					presetCheckBox("status_gz_5", false);
					document.getElementById("wifiName_5g").disabled = true;
					document.getElementById("password_5g").disabled = true;
					//Get5GHzHostZoneResult = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:5/Enabled");
				}
				var ssid_guest5 = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:2/SSID");
				document.getElementById("wifiName_5g").value = ssid_guest5;
				var security_5_status = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:2/Enabled");
				if(security_5_status != "false")
				{
					var password_guest5 = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:2/Key");
					document.getElementById("password_5g").value= password_guest5;
				}
				//5g high band
				var radio_guest5hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:3/Enabled");
				Get5GHzHostZoneResult_hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:6/Enabled");
				if(radio_guest5hi == "true" && Get5GHzHostZoneResult_hi == "true")	{	presetCheckBox("status_gz_5hi", true);	}
				else
				{
					presetCheckBox("status_gz_5hi", false);
					document.getElementById("wifiName_5g_hi").disabled = true;
					document.getElementById("password_5g_hi").disabled = true;
					//Get5GHzHostZoneResult_hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:6/Enabled");
				}
				var ssid_guest5hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:3/SSID");
				document.getElementById("wifiName_5g_hi").value = ssid_guest5hi;
				var security_5_status_hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:3/Enabled");
				if(security_5_status_hi != "false")
				{
					var password_guest5hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSecurityResponse:3/Key");
					document.getElementById("password_5g_hi").value= password_guest5hi;
				}
			}
			//internetAccessOnly_status
			var internetAccessOnly_status = result_xml.Get("GetMultipleHNAPsResponse/GetGuestZoneRouterSettingsResponse/InternetAccessOnly");
			if(internetAccessOnly_status == "true")
			{
				presetCheckBox("internetAccessOnly", true);
				document.getElementById("RBZ_Table").style.display = "table-row";
			}
			else
			{
				presetCheckBox("internetAccessOnly", false);
				if (document.getElementById("status_gz_24_ck").checked == "1" || document.getElementById("status_gz_5_ck").checked == "1" || document.getElementById("status_gz_5hi_ck").checked == "1")	{	document.getElementById("RBZ_Table").style.display = "table-row";	}
				else	{	document.getElementById("RBZ_Table").style.display = "none";	}
			}
			n24G_SSID = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/SSID");
			n24G_Mode = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/Mode");
			n24G_Channel = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/Channel");
			n24G_TXPower = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/TXPower");
			n24G_ChannelWidth = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/ChannelWidth");
			n24G_Visibility = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:4/SSIDBroadcast");
			n5G_SSID = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:5/SSID");
			n5G_Mode = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:5/Mode");
			n5G_Channel = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:5/Channel");
			n5G_TXPower = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:5/TXPower");
			n5G_ChannelWidth = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:5/ChannelWidth");
			n5G_Visibility = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:5/SSIDBroadcast");
			n5G_SSID_hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:6/SSID");
			n5G_Mode_hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:6/Mode");
			n5G_Channel_hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:6/Channel");
			n5G_TXPower_hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:6/TXPower");
			n5G_ChannelWidth_hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:6/ChannelWidth");
			n5G_Visibility_hi = result_xml.Get("GetMultipleHNAPsResponse/GetWLanRadioSettingsResponse:6/SSIDBroadcast");

			CheckNetworkStatus();
			document.getElementById("main").style.display = "inline";
		}
		else	{	if (DebugMode == 1)	{	alert("[!!GetXML Error!!] Function: GetResult_2nd");	}	}
	}
	function CheckConnectionStatus()
	{
		$.ajax({
			cache : false,
			url : "./js/CheckConnection",
			timeout : 5000,
			type : "GET",
			success : function(data) { SetXML(); },
			error : function() { document.getElementById("DetectRouterConnection").style.display = "inline"; }
		});
	}
	function SetXML()
	{
		if (GetHostZoneEnabled_24 == 0 && GetHostZoneEnabled_5 == 0 && GetHostZoneEnabled_5hi == 0)
		{
			document.getElementById("CreatePopAlertMessage").style.display = "inline";
			document.getElementById("waitSettingFinish").style.display = "inline";
			HNAP.GetXMLAsync("SetWLanRadioSettings", null, "GetXML", function(xml)	{	SetResult_1st(xml)	});
		}
		else
		{
			document.getElementById("CreatePopAlertMessage").style.display = "inline";
			document.getElementById("EnableHostZoneCheck").style.display = "inline";
		}
	}
	function SetResult_1st(result_xml)
	{
		if (GetHostZoneEnabled_24 == 0 && GetHostZoneEnabled_5 == 0 && GetHostZoneEnabled_5hi == 0)
		{
			if (result_xml != null)
			{
				HNAP_WLanRadioSettings = result_xml;
				result_xml.Set("SetWLanRadioSettings/RadioID", "RADIO_2.4G_Guest");
				// 2.4 GHz Guest Zone Enable
				// RADIO_2.4GHz Enable
				var selectWirelessMode_24 = document.getElementById("status_gz_24_ck").checked;
				if(selectWirelessMode_24 == "1")	{	result_xml.Set("SetWLanRadioSettings/Enabled", "true");	}
				else								{	result_xml.Set("SetWLanRadioSettings/Enabled", "false");	}
				// 2.4 GHz Guest Zone SSID
				result_xml.Set("SetWLanRadioSettings/SSID", document.getElementById("wifiName_24g").value);
				// 2.4 GHz Guest Zone Mode
				result_xml.Set("SetWLanRadioSettings/Mode", n24G_Mode);
				// 2.4 GHz Guest Zone Channel
				result_xml.Set("SetWLanRadioSettings/Channel", n24G_Channel);
				// 2.4 GHz Guest Zone Channel Width
				result_xml.Set("SetWLanRadioSettings/ChannelWidth", n24G_ChannelWidth);
				// 2.4 GHz Guest Zone Visibility Status
				result_xml.Set("SetWLanRadioSettings/SSIDBroadcast", "true");
				// 2.4 GHz Guest Zone Secondary Channel Setting
				result_xml.Set("SetWLanRadioSettings/SecondaryChannel", "0");
				// Send HNAP to DUT
				HNAP.SetXMLAsync("SetWLanRadioSettings", result_xml, function(xml)	{	SetResult_2nd(xml);	});
			}
			else	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_1st");	}	}
		}
		else if (GetHostZoneEnabled_24 == 1 || GetHostZoneEnabled_5 == 1 || GetHostZoneEnabled_5hi == 1)
		{
			var SetResult_1st = result_xml.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult");
			if (SetResult_1st == "OK")
			{
				var xml = HNAP_WLanRadioSettings;
				xml.Set("SetWLanRadioSettings/RadioID", "RADIO_2.4G_Guest");
				// 2.4 GHz Guest Zone Enable
				// RADIO_2.4GHz Enable
				var selectWirelessMode_24 = document.getElementById("status_gz_24_ck").checked;
				if(selectWirelessMode_24 == "1")	{	xml.Set("SetWLanRadioSettings/Enabled", "true");	}
				else								{	xml.Set("SetWLanRadioSettings/Enabled", "false");	}
				// 2.4 GHz Guest Zone SSID
				xml.Set("SetWLanRadioSettings/SSID", document.getElementById("wifiName_24g").value);
				// 2.4 GHz Guest Zone Mode
				xml.Set("SetWLanRadioSettings/Mode", n5G_Mode);
				// 2.4 GHz Guest Zone Channel
				xml.Set("SetWLanRadioSettings/Channel", n5G_Channel);
				// 2.4 GHz Guest Zone Channel Width
				xml.Set("SetWLanRadioSettings/ChannelWidth", n5G_ChannelWidth);
				// 2.4 GHz Guest Zone Visibility Status
				xml.Set("SetWLanRadioSettings/SSIDBroadcast", "true");
				// 2.4 GHz Guest Zone Secondary Channel Setting
				xml.Set("SetWLanRadioSettings/SecondaryChannel", "0");
				// Send HNAP to DUT
				HNAP.SetXMLAsync("SetWLanRadioSettings", xml, function(xml)	{	SetResult_2nd(xml);	});
			}
			if (SetResult_1st == "ERROR")	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_1st");	}	window.location.reload();	}
		}
		else	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_1st");	}	}
	}

	function SetResult_2nd(result_xml)
	{
		var SetResult_2nd = result_xml.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult");
		if (SetResult_2nd == "OK")		{	HNAP.GetXMLAsync("SetWLanRadioSecurity", null, "GetXML", function(xml)	{	SetResult_3rd(xml)	});	}
		if (SetResult_2nd == "ERROR")	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_2nd");	}	window.location.reload();	}
	}
	function SetResult_3rd(result_xml)
	{
		HNAP_WLanRadioSecurity = result_xml;
		if (result_xml != null)
		{
			result_xml.Set("SetWLanRadioSecurity/RadioID", "RADIO_2.4G_Guest");
			if (document.getElementById("password_24g").value != "")
			{
				result_xml.Set("SetWLanRadioSecurity/Enabled", "true");
				result_xml.Set("SetWLanRadioSecurity/Type", "WPAORWPA2-PSK");
				result_xml.Set("SetWLanRadioSecurity/Encryption", "TKIPORAES");
				result_xml.Set("SetWLanRadioSecurity/KeyRenewal", "3600");
				result_xml.Set("SetWLanRadioSecurity/Key", document.getElementById("password_24g").value);
			}
			else	{	result_xml.Set("SetWLanRadioSecurity/Enabled", "false");	}
			// Send HNAP to DUT
			HNAP.SetXMLAsync("SetWLanRadioSecurity", result_xml, function(xml)	{	SetResult_4th(xml);	});
		}
		else	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_3rd");	}	window.location.reload();	}
	}
	function SetResult_4th(result_xml)
	{
		var SetResult_4th = result_xml.Get("SetWLanRadioSecurityResponse/SetWLanRadioSecurityResult");
		if (SetResult_4th == "OK")
		{
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/RadioID", "RADIO_5G_Guest");
			// 5 GHz Enable
			var selectWirelessMode_5 = document.getElementById("status_gz_5_ck").checked;
			if(selectWirelessMode_5 == "1")	{	HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Enabled", "true");	}
			else							{	HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Enabled", "false");	}
			// 5 GHz Guest Zone SSID
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/SSID", document.getElementById("wifiName_5g").value);
			// 5 GHz Guest Zone Mode
			if (IsSupport11ac_5GHz != "1")	{	HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Mode", "802.11an");	}
			else							{	HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Mode", "802.11anac");	}
			// 5 GHz Guest Zone Channel
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Channel", n5G_Channel);
			// 5 GHz Guest Zone Channel Width
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/ChannelWidth", n5G_ChannelWidth);
			// 5 GHz Guest Zone Visibility Status
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/SSIDBroadcast", "true");
			// 5 GHz Guest Zone Secondary Channel Setting
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/SecondaryChannel", "0");
			// Send HNAP to DUT
				HNAP.SetXMLAsync("SetWLanRadioSettings", HNAP_WLanRadioSettings, function(xml)	{	SetResult_5th(xml);	});
		}
		if (SetResult_4th == "ERROR")	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_4th");	}	window.location.reload();	}
	}

	function SetResult_5th(result_xml)
	{
		var SetResult_5th = result_xml.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult");
		if (SetResult_5th == "OK")
		{
			var tmpxml = HNAP_WLanRadioSecurity;
			tmpxml.Set("SetWLanRadioSecurity/RadioID", "RADIO_5G_Guest");
			if (document.getElementById("password_5g").value != "")
			{
				tmpxml.Set("SetWLanRadioSecurity/Enabled", "true");
				tmpxml.Set("SetWLanRadioSecurity/Type", "WPAORWPA2-PSK");
				tmpxml.Set("SetWLanRadioSecurity/Encryption", "TKIPORAES");
				tmpxml.Set("SetWLanRadioSecurity/KeyRenewal", "3600");
				tmpxml.Set("SetWLanRadioSecurity/Key", document.getElementById("password_5g").value);
			}
			else	{	tmpxml.Set("SetWLanRadioSecurity/Enabled", "false");	}
			// Send HNAP to DUT
			HNAP.SetXMLAsync("SetWLanRadioSecurity", tmpxml, function(xml)	{	SetResult_4th_1(xml);	});
		}
		if (SetResult_5th == "ERROR")	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_5th");	}	window.location.reload();	}
	}
	function SetResult_4th_1(result_xml)
	{
		var SetResult_4th_1 = result_xml.Get("SetWLanRadioSecurityResponse/SetWLanRadioSecurityResult");
		if (SetResult_4th_1 == "OK")
		{
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/RadioID", "RADIO_5GHz_2_Guest");
			// 5 GHz Enable
			var selectWirelessMode_5hi = document.getElementById("status_gz_5hi_ck").checked;
			if(selectWirelessMode_5hi == "1")	{	HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Enabled", "true");	}
			else							{	HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Enabled", "false");	}
			// 5 GHz Guest Zone SSID
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/SSID", document.getElementById("wifiName_5g_hi").value);
			// 5 GHz Guest Zone Mode
			if (IsSupport11ac_5GHz != "1")	{	HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Mode", "802.11an");	}
			else							{	HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Mode", "802.11anac");	}
			// 5 GHz Guest Zone Channel
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/Channel", n5G_Channel_hi);
			// 5 GHz Guest Zone Channel Width
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/ChannelWidth", n5G_ChannelWidth_hi);
			// 5 GHz Guest Zone Visibility Status
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/SSIDBroadcast", "true");
			// 5 GHz Guest Zone Secondary Channel Setting
			HNAP_WLanRadioSettings.Set("SetWLanRadioSettings/SecondaryChannel", "0");
			// Send HNAP to DUT
				HNAP.SetXMLAsync("SetWLanRadioSettings", HNAP_WLanRadioSettings, function(xml)	{	SetResult_5th_1(xml);	});
		}
		if (SetResult_4th_1 == "ERROR")	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_4th_1");	}	window.location.reload();	}
	}
	function SetResult_5th_1(result_xml)
	{
		var SetResult_5th_1 = result_xml.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult");
		if (SetResult_5th_1 == "OK")
		{
			var tmpxml = HNAP_WLanRadioSecurity;
			tmpxml.Set("SetWLanRadioSecurity/RadioID", "RADIO_5GHz_2_Guest");
			if (document.getElementById("password_5g_hi").value != "")
			{
				tmpxml.Set("SetWLanRadioSecurity/Enabled", "true");
				tmpxml.Set("SetWLanRadioSecurity/Type", "WPAORWPA2-PSK");
				tmpxml.Set("SetWLanRadioSecurity/Encryption", "TKIPORAES");
				tmpxml.Set("SetWLanRadioSecurity/KeyRenewal", "3600");
				tmpxml.Set("SetWLanRadioSecurity/Key", document.getElementById("password_5g_hi").value);
			}
			else	{	tmpxml.Set("SetWLanRadioSecurity/Enabled", "false");	}
			// Send HNAP to DUT
			HNAP.SetXMLAsync("SetWLanRadioSecurity", tmpxml, function(xml)	{	SetResult_6th(xml);	});
		}
		if (SetResult_5th_1 == "ERROR")	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_5th_1");	}	window.location.reload();	}
	}
	function SetResult_6th(result_xml)
	{
		var SetResult_6th = result_xml.Get("SetWLanRadioSecurityResponse/SetWLanRadioSecurityResult");
		if (SetResult_6th == "OK")		{	HNAP.GetXMLAsync("SetGuestZoneRouterSettings", null, "GetXML", function(xml)	{	SetResult_7th(xml)	});	}
		if (SetResult_6th == "ERROR")	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_6th");	}	window.location.reload();	}
	}
	function SetResult_7th(result_xml)
	{
		if (result_xml != null)
		{
			//  Routing Between Zone
			if (document.getElementById("internetAccessOnly_ck").checked == "1")
			{
				result_xml.Set("SetGuestZoneRouterSettings/InternetAccessOnly", "true");
				result_xml.Set("SetGuestZoneRouterSettings/DHCPServer", "true");
			}
			else
			{
				result_xml.Set("SetGuestZoneRouterSettings/InternetAccessOnly", "false");
				result_xml.Set("SetGuestZoneRouterSettings/DHCPServer", "false");
			}
			// Send HNAP to DUT
			HNAP.SetXMLAsync("SetGuestZoneRouterSettings", result_xml, function(xml)	{	SetResult_8th(xml);	});
		}
		else	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_7th");	}	window.location.reload();	}
	}

	function SetResult_8th(result_xml)
	{
		var SetResult_8th = result_xml.Get("SetGuestZoneRouterSettingsResponse/SetGuestZoneRouterSettingsResult");
		if (SetResult_8th == "OK")
		{
			document.getElementById("result_Message").innerHTML = I18N("j", "Your changes are being saved. When reconnecting to this device, please use the new Wi-Fi name and password you created.");
			Start_reciprocal_Number_RestoreConfiguration();
		}
		if (SetResult_8th == "ERROR")	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_8th");	}	window.location.reload();	}
	}
	function Show_Table()
	{
		if (document.getElementById("status_gz_24_ck").checked == "1" || document.getElementById("status_gz_5_ck").checked == "1" || document.getElementById("status_gz_5hi_ck").checked == "1")
		{
	//		presetCheckBox("internetAccessOnly", true);
			document.getElementById("RBZ_Table").style.display = "table-row";
		}
		else
		{
	//		presetCheckBox("internetAccessOnly", false);
			document.getElementById("RBZ_Table").style.display = "none";
		}
	}

	function returnToMain()
	{
		document.getElementById("CreatePopAlertMessage").style.display = "none";
		document.getElementById("EnableHostZoneCheck").style.display = "none";
	}
	function SetupHostZone()
	{
		document.getElementById("CreatePopAlertMessage").style.display = "inline";
		document.getElementById("EnableHostZoneCheck").style.display = "none";
		document.getElementById("waitSettingFinish").style.display = "inline";
		HNAP.GetXMLAsync("SetWLanRadioSettings", null, "GetXML", function(xml)	{	SetResult_9th(xml)	});
	}
	function SetResult_9th(result_xml)
	{
		HNAP_WLanRadioSettings = result_xml;
		if (result_xml != null)
		{
			if (GetHostZoneEnabled_24 == 1)
			{
				result_xml.Set("SetWLanRadioSettings/RadioID", "RADIO_2.4GHz");
				result_xml.Set("SetWLanRadioSettings/Enabled", "true");
				result_xml.Set("SetWLanRadioSettings/SSID", n24G_SSID);
				result_xml.Set("SetWLanRadioSettings/Mode", n24G_Mode);
				result_xml.Set("SetWLanRadioSettings/Channel", n24G_Channel);
				result_xml.Set("SetWLanRadioSettings/TXPower", n24G_TXPower);
				result_xml.Set("SetWLanRadioSettings/ChannelWidth", n24G_ChannelWidth);
				result_xml.Set("SetWLanRadioSettings/SSIDBroadcast", n24G_Visibility);
				if (GetHostZoneEnabled_5 == 0 && GetHostZoneEnabled_5hi == 0)	{	HNAP.SetXMLAsync("SetWLanRadioSettings", result_xml, function(xml)	{	SetResult_1st(xml);	});	}
				else						{	HNAP.SetXMLAsync("SetWLanRadioSettings", result_xml, function(xml)	{	SetResult_10th(xml);	});	}
			}
			else if (GetHostZoneEnabled_5 == 1)
			{
				result_xml.Set("SetWLanRadioSettings/RadioID", "RADIO_5GHz");
				result_xml.Set("SetWLanRadioSettings/Enabled", "true");
				result_xml.Set("SetWLanRadioSettings/SSID", n5G_SSID);
				result_xml.Set("SetWLanRadioSettings/Mode", n5G_Mode);
				result_xml.Set("SetWLanRadioSettings/Channel", n5G_Channel);
				result_xml.Set("SetWLanRadioSettings/TXPower", n5G_TXPower);
				result_xml.Set("SetWLanRadioSettings/ChannelWidth", n5G_ChannelWidth);
				result_xml.Set("SetWLanRadioSettings/SSIDBroadcast", n5G_Visibility);
				// Send HNAP to DUT
				if (GetHostZoneEnabled_5hi == 0)	{	HNAP.SetXMLAsync("SetWLanRadioSettings", result_xml, function(xml)	{	SetResult_1st(xml);	});	}
				else						{	HNAP.SetXMLAsync("SetWLanRadioSettings", result_xml, function(xml)	{	SetResult_11th(xml);	});	}
			}
			else if (GetHostZoneEnabled_5hi == 1)
			{
				result_xml.Set("SetWLanRadioSettings/RadioID", "RADIO_5GHz_2");
				result_xml.Set("SetWLanRadioSettings/Enabled", "true");
				result_xml.Set("SetWLanRadioSettings/SSID", n5G_SSID_hi);
				result_xml.Set("SetWLanRadioSettings/Mode", n5G_Mode_hi);
				result_xml.Set("SetWLanRadioSettings/Channel", n5G_Channel_hi);
				result_xml.Set("SetWLanRadioSettings/TXPower", n5G_TXPower_hi);
				result_xml.Set("SetWLanRadioSettings/ChannelWidth", n5G_ChannelWidth_hi);
				result_xml.Set("SetWLanRadioSettings/SSIDBroadcast", n5G_Visibility_hi);
				// Send HNAP to DUT
				HNAP.SetXMLAsync("SetWLanRadioSettings", result_xml, function(xml)	{	SetResult_1st(xml);	});
			}
			else	{	alert("An error occurred!");	window.location.reload();	}
		}
	}
	function SetResult_10th(result_xml)
	{
		var Get_SetXml = HNAP_WLanRadioSettings;
		var SetResult_10th = result_xml.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult");
		if (SetResult_10th == "OK")
		{
			if (GetHostZoneEnabled_5 == 1)
			{
				result_xml.Set("SetWLanRadioSettings/RadioID", "RADIO_5GHz");
				result_xml.Set("SetWLanRadioSettings/Enabled", "true");
				result_xml.Set("SetWLanRadioSettings/SSID", n5G_SSID);
				result_xml.Set("SetWLanRadioSettings/Mode", n5G_Mode);
				result_xml.Set("SetWLanRadioSettings/Channel", n5G_Channel);
				result_xml.Set("SetWLanRadioSettings/TXPower", n5G_TXPower);
				result_xml.Set("SetWLanRadioSettings/ChannelWidth", n5G_ChannelWidth);
				result_xml.Set("SetWLanRadioSettings/SSIDBroadcast", n5G_Visibility);
				// Send HNAP to DUT
				if (GetHostZoneEnabled_5hi == 0)	{	HNAP.SetXMLAsync("SetWLanRadioSettings", result_xml, function(xml)	{	SetResult_1st(xml);	});	}
				else						{	HNAP.SetXMLAsync("SetWLanRadioSettings", result_xml, function(xml)	{	SetResult_11th(xml);	});	}
			}
			else if (GetHostZoneEnabled_5hi == 1)
			{
				result_xml.Set("SetWLanRadioSettings/RadioID", "RADIO_5GHz_2");
				result_xml.Set("SetWLanRadioSettings/Enabled", "true");
				result_xml.Set("SetWLanRadioSettings/SSID", n5G_SSID_hi);
				result_xml.Set("SetWLanRadioSettings/Mode", n5G_Mode_hi);
				result_xml.Set("SetWLanRadioSettings/Channel", n5G_Channel_hi);
				result_xml.Set("SetWLanRadioSettings/TXPower", n5G_TXPower_hi);
				result_xml.Set("SetWLanRadioSettings/ChannelWidth", n5G_ChannelWidth_hi);
				result_xml.Set("SetWLanRadioSettings/SSIDBroadcast", n5G_Visibility_hi);
				// Send HNAP to DUT
				HNAP.SetXMLAsync("SetWLanRadioSettings", result_xml, function(xml)	{	SetResult_1st(xml);	});
			}
		}
		if (SetResult_10th == "ERROR")	{	alert("An error occurred!");	window.location.reload();	}
	}
	function SetResult_11th(result_xml)
	{
		var Get_SetXml = HNAP_WLanRadioSettings;
		var SetResult_11th = result_xml.Get("SetWLanRadioSettingsResponse/SetWLanRadioSettingsResult");
		if (SetResult_11th == "OK")
		{
			Get_SetXml.Set("SetWLanRadioSettings/RadioID", "RADIO_5GHz_2");
			Get_SetXml.Set("SetWLanRadioSettings/Enabled", "true");
			Get_SetXml.Set("SetWLanRadioSettings/SSID", n5G_SSID_hi);
			Get_SetXml.Set("SetWLanRadioSettings/Mode", n5G_Mode_hi);
			Get_SetXml.Set("SetWLanRadioSettings/Channel", n5G_Channel_hi);
			Get_SetXml.Set("SetWLanRadioSettings/TXPower", n5G_TXPower_hi);
			Get_SetXml.Set("SetWLanRadioSettings/ChannelWidth", n5G_ChannelWidth_hi);
			Get_SetXml.Set("SetWLanRadioSettings/SSIDBroadcast", n5G_Visibility_hi);
			// Send HNAP to DUT
			HNAP.SetXMLAsync("SetWLanRadioSettings", Get_SetXml, function(xml)	{	SetResult_1st(xml);	});
		}
		if (SetResult_11th == "ERROR")	{	alert("An error occurred!");	window.location.reload();	}
	}
	function Start_reciprocal_Number_RestoreConfiguration()
	{
		if (_ReciprocalNumber >= 0)
		{
			document.getElementById("reciprocal_Number").innerHTML = _ReciprocalNumber + " " + I18N("j", "Sec");
			_ReciprocalNumber --;
			setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
		}
		else	{	window.location.reload();	}
	}
	function CheckNetworkStatus()
	{
		var status = sessionStorage.getItem('networkStatus');
		if ((status == 1)&&(currentDevice.helpVer != ""))	{	document.getElementById("Get_Help").style.display = "inline";	}
		else				{	document.getElementById("Get_Help").style.display = "none";		}
	}
	function mouseClick(obj)	{	window.open("http://support.dlink.com/");	}
</script>
<script language="JavaScript">
	// 2013/09/23 Timmy Modify
	$(function() {
		$("select").change(function () {	save_button_changed();	});
		$("input").keydown(function () {	save_button_changed();	});
	});
	function save_button_changed()
	{
		document.getElementById("Save_Disable_btn").style.display = "none";
		document.getElementById("Save_btn").style.display = "block";
		changeFlag = true;
		checkFlag = true;
		GetClickTime();
	}
</script>
</head>

<body>
	<form name="wifi_guest_form" id="wifi_guest_form" method="POST" action="" novalidate="novalidate">
	<div id="wrapper">
		<!-------------------- Logo ------------------------->
		<div id="header"><div>
	<div style="position:relative; top:37px;">
		<a href="http://www.dlink.com/" target="_blank">
			<img id="image_Logo" src="resources/logo_2.png" alt="D-Link" width="102" height="20" border="0">
		</a>
	</div>
	<table id="device_ver" style="position:relative; top:33px; font-size:13px; color:#969696;" border="0">
		<tbody>
			<tr>
				<td style="padding: 0 10px 0 0;"><label id="h_ModelName">DIR-890L</label></td>
				<td style="padding: 0 10px 0 0;">HW:<label id="h_HWVersion">A1</label></td>
				<td style="padding: 0 10px 0 0;">FW:<label id="h_FWVersion">1.00</label></td>
			</tr>
		</tbody>
	</table>

</div></div>
		<!-------------------- Menu ------------------------->
		<div id="menu"><ul>	<li><a id="menu_Home" href="Home.html">Home</a></li>	<li class="parent" onmouseover="this.className=&quot;parentOn&quot;" onmouseout="this.className=&quot;parent&quot;">
		<a id="menu_Settings" href="#" style="background: url(resources/navigation_bg5.gif?v=20141117210117) 100% 0% no-repeat;">Settings</a>		
		
		<ul>			
		
		<li><a href="Wizard_Manual.html" onclick="return confirmExit()">Wizard</a></li>			
		<li><a href="Internet.html" onclick="return confirmExit();">Internet</a></li>			
		
		<li><a href="WiFi.html" onclick="return confirmExit()">Wireless</a></li>
		<li><a href="Network.html" onclick="return confirmExit()">Network</a></li>	
		<li><a href="SharePort.html" onclick="return confirmExit()">SharePort</a></li>	
		<li><a href="Mydlink.html" onclick="return confirmExit()">mydlink</a></li>

		</ul>	</li>	
		
		
		<li class="parent" onmouseover="this.className=&quot;parentOn&quot;" onmouseout="this.className=&quot;parent&quot;"><a id="menu_Advanced" href="#">Features</a>		
		<ul>			
		
		<li><a href="QoS.html" onclick="return confirmExit()">QoS Engine</a></li>			
		<li><a href="Firewall.html" onclick="return confirmExit()">Firewall</a></li>			
		<li><a href="PortForwarding.html" onclick="return confirmExit()">Port Forwarding</a></li>			
		<li><a href="WebsiteFilter.html" onclick="return confirmExit()">Website Filter</a></li>			
		<li><a href="StaticRoute.html" onclick="return confirmExit()">Static Route</a></li>			
		<li><a href="DynamicDNS.html" onclick="return confirmExit()">Dynamic DNS</a></li>			
		<li><a href="VPN.html" onclick="return confirmExit()">Quick VPN</a></li>

		</ul>	</li>	
		
		<li class="parent" onmouseover="this.className=&quot;parentOn&quot;" onmouseout="this.className=&quot;parent&quot;">
		
		<a id="menu_Management" href="#">Management</a>		
		
		<ul>	
		
		<li><a href="Time.html" onclick="return confirmExit()">Time &amp; Schedule</a></li>			
		<li><a href="SystemLog.html" onclick="return confirmExit()">System Log</a></li>			
		<li><a href="Admin.html" onclick="return confirmExit()">System Admin</a></li>			
		<li><a href="UpdateFirmware.html" onclick="return confirmExit()">Upgrade</a></li>			
		<li><a href="Statistics.html" onclick="return confirmExit()">Statistics</a></li>		
		
		</ul>	
		
		</li></ul></div>
		
		
		<div id="menu_edge"></div>
		<!-------------------- Content ---------------------->
		<div id="content">
			<!-------------------- info ---------------------->
	  		<div id="info">
			  	<div id="FunctionName">Guest Zone</div>
				<div id="wallimage"><img src="resources/Guest.png" alt="" width="195" height="119"></div>
		      	<div id="directions">
					This page lets you enable and configure a Wi-Fi Guest Zone. Users connected to a Guest Zone cannot communicate or detect devices on your home network unless Internet Access Only is disabled under Home Network Access.
					<label id="Get_Help" onclick="window.open('http://support.dlink.com')" style="cursor: pointer; display: inline; text-decoration: underline;">Click here for help.</label>
				</div>
			</div>
			<!-------------------- funcBar ---------------------->
			<div id="funcBar">
				<div id="pagePath">Settings &gt;&gt; Wireless &gt;&gt; Guest Zone</div>
				<ul id="rightFunc">
					<li style="display:block"><div id="Save_btn" onclick='alert("This feature has been disabled on this emulator.")' style="cursor:pointer; display:none">Save</div></li>
					<li style="display:block"><div id="Save_Disable_btn">Save</div></li>
					<input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none">
					<li style="display:block"><a href="WiFi.html" style="text-decoration:none;" onclick="return confirmExit()"><div id="page_btn" class="linkstyle_1">Wi-Fi</div></a></li>
				</ul>
			</div>
			<!-------------------- main ---------------------->
	     	<div id="main" style="display: inline;">
				<!----- start of Smart Connect Settings ----->
				<div id="SMART_CONNECT" style="display: none;">
					<table class="block" border="0" cellspacing="0" style="margin: 10px 0 0 0;">
						<tbody>
							<tr>
								<td><div class="title">Smart Connect</div></td>
								<td></td>
							</tr>
							<tr style="display:none;">
								<th>Smart Connect:</th>
								<td>
									<div id="status_smartconnect" class="checkbox_off"><input type="checkbox" name="status_smartconnect" id="status_smartconnect_ck" checked="">Disabled</div>
								</td>
							</tr>
							<tr>
								<th>Wi-Fi Name (SSID):</th>
								<td><input class="styled-text" type="text" name="wifiName_smartconnect" maxlength="32" size="30" id="wifiName_smartconnect"></td>
							</tr>
							<tr>
								<th>Password:</th>
								<td><input class="styled-text" type="text" name="password_smartconnect" size="30" id="password_smartconnect"></td>
							</tr>
						</tbody>
					</table>
				</div>
				<!----- end of Smart Connect Settings ----->
				<div id="separated_line" style="display: none;">
					<hr>
				</div>
				<!-------------------- Wi-Fi 2.4GHz ---------------------->
				<table id="GUEST_2GHz" class="block" style="margin: 10px 0px 0px; display: table-row;">
					<tbody>
						<tr>
							<td><div class="title">2.4GHz</div></td>
						</tr>
						<tr>
							<th>Status:</th>
							<td><div id="status_gz_24" class="checkbox_off"><input type="checkbox" name="status_gz_24" id="status_gz_24_ck" checked="">Disabled</div></td>
						</tr>
						<tr>
							<th>Wi-Fi Name (SSID):</th>
							<td><input class="styled-text" type="text" name="wifiName_24g" size="30" id="wifiName_24g" maxlength="32" disabled=""></td>
						</tr>
						<tr>
							<th>Password:</th>
							<td><input class="styled-text" type="text" name="password_24g" size="30" id="password_24g" maxlength="63" disabled=""></td>
						</tr>
					</tbody>
				</table>
				<div id="separated_line_2GHz" style="display: block;">
					<hr>
				</div>
				<!-------------------- Wi-Fi 5GHz Low Band ---------------------->
				<table id="GUEST_5GHz" class="block" style="margin: 10px 0px 0px; display: table-row;">
					<tbody>
						<tr>
							<td><div class="title">Primary 5GHz</div></td>
						</tr>
						<tr>
							<th>Status:</th>
							<td><div id="status_gz_5" class="checkbox_off"><input type="checkbox" name="status_gz_5" id="status_gz_5_ck" checked="">Disabled</div></td>
						</tr>
						<tr>
							<th>Wi-Fi Name (SSID):</th>
							<td><input class="styled-text" type="text" name="wifiName_5g" size="30" id="wifiName_5g" maxlength="32" disabled=""></td>
						</tr>
						<tr>
							<th>Password:</th>
							<td><input class="styled-text" type="text" name="password_5g" size="30" id="password_5g" maxlength="63" disabled=""></td>
						</tr>
					</tbody>
				</table>
				<div id="separated_line_5GHz" style="display: block;">
					<hr>
				</div>
				<!-------------------- Wi-Fi 5GHz High Band ---------------------->
				<table id="GUEST_5GHz_hi" class="block" style="margin: 10px 0px 0px; display: table-row;">
					<tbody>
						<tr>
							<td><div class="title">Secondary 5GHz</div></td>
						</tr>
						<tr>
							<th>Status:</th>
							<td><div id="status_gz_5hi" class="checkbox_off"><input type="checkbox" name="status_gz_5hi" id="status_gz_5hi_ck" checked="">Disabled</div></td>
						</tr>
						<tr>
							<th>Wi-Fi Name (SSID):</th>
							<td><input class="styled-text" type="text" name="wifiName_5g_hi" size="30" id="wifiName_5g_hi" maxlength="32" disabled=""></td>
						</tr>
						<tr>
							<th>Password:</th>
							<td><input class="styled-text" type="text" name="password_5g_hi" size="30" id="password_5g_hi" maxlength="63" disabled=""></td>
						</tr>
					</tbody>
				</table>
				<hr>
				<!-------------------- Internet Access Only ---------------------->
				<table class="block" id="RBZ_Table" style="margin: 10px 0px 0px; display: table-row;">
					<tbody>
						<tr>
							<td><div class="title">Home Network Access</div></td>
						</tr>
						<tr>
							<th>Internet Access Only:</th>
							<td><div id="internetAccessOnly" class="checkbox_on"><input type="checkbox" name="internetAccessOnly" id="internetAccessOnly_ck" checked="">Enabled</div></td>
						</tr>
					</tbody>
				</table>
		 	</div>
		 	<div id="CreatePopAlertMessage" style="display:none">
				<div id="AlertPopRect">
				<div id="AlertPopBody">
					<table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none">
					   <tbody>
							 <tr>
							 	<td>
									<center><div id="Loading_pop_image"></div></center>
								</td>
							 </tr>
							 <tr>
							 	<td><label id="reciprocal_Number"></label></td>
							 </tr>
							 <tr>
							 	<td id="dialog_msg_black"><label id="result_Message">Your changes are being saved.</label></td>
							 </tr>
					   </tbody>
					</table>
					<table class="myAlertPop_table_b" id="EnableHostZoneCheck" border="0" cellspacing="0" style="display:none">
						<tbody>
							<tr>
								<td colspan="2">
									<center><div id="Information_pop_image"></div></center>
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<center><div id="dialog_msg_black">Your Wi-Fi network needs to be enabled in order to turn on Guest Zone network. Would you like to turn on both?</div><center>
								</center></center></td>
							</tr>
							<tr>
								<td>
									<div id="Confirm_btn" onclick="SetupHostZone()" style="cursor:pointer">OK</div>
								</td>
								<td>
									<div id="Confirm_btn" onclick="returnToMain()" style="cursor:pointer">Cancel</div>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
				</div>
			</div>
		</div>
		<!-- Detect Router Connection, Timmy Add 2013/08/15 -->
		<div id="DetectRouterConnection" style="display:none"><div class="dialogBox" style="width:616px"><table class="myCreatePop_table" border="0" cellspacing="0" id="RouterConnectionTable"><tbody><tr><td colspan="3"><div class="popTitle">Router Not Found</div></td></tr><tr><td id="save_td" colspan="4"><center><div id="Save_edit_pop_btn" style="cursor:pointer" tabindex="12" onclick="CheckHTMLStatus(&#39;&#39;);">Retry</div></center></td></tr></tbody></table></div></div>
		<div id="footer">
			<div id="copyright">COPYRIGHT Â© 2014 D-Link</div>
		</div>
	</div>
	</form>
<script type="text/javascript" charset="utf-8">
	$(document).ready( function() {
		var customError = "";
		$.validator.setDefaults( { submitHandler: function(form) { form.submit(); } } );

		// Check Is WPA
		$.validator.addMethod("checkWPAPassword", function( value, element ) {
			var returnVal = true;
			if (value.length != 0)
			{
				if (value.length > 63 || value.length < 8)
				{
					returnVal = false;
				}
			}
			else
			{
				returnVal = true;
			}
			return returnVal;
		}, jQuery.validator.messages.password_WPACheck);

		// check wifi ssid
		$.validator.addMethod("checkssid", function( value, element ) {
			var returnVal = true;
			if (value == "")
			{
				returnVal = false;
			}
			else
			{
				returnVal = true;
			}
			return returnVal;
		}, jQuery.validator.messages.ssid);

		$('#wifi_guest_form').validate({
			rules: {
				//wifiName_24g: "required",
				wifiName_24g: {
					checkssid: true
				},
				password_24g: {
					checkWPAPassword: true
				},
				//wifiName_5g: "required",
				wifiName_5g: {
					checkssid: true
				},
				password_5g: {
					checkWPAPassword: true
				},
				//wifiName_5g_hi: "required",
				wifiName_5g_hi: {
					checkssid: true
				},
				password_5g_hi: {
					checkWPAPassword: true
				}
			},
			submitHandler: function(form) {
				CheckConnectionStatus();
			}
		});
	});
</script>
<!--
<script type="text/javascript">
	Load_HTML();
	Initial();
	setMenu("menu_Settings");
	GetXML();
	checkTimeout();
</script>

-->
</body></html>